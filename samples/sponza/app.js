require(["Core/Engine","Core/EventHandler","Loading/SceneLoader","Passes/UpdatePass","Passes/RenderPass","Renderer/BackBufferTarget","loading","Math/Math"],function(e,a,n,t,r,d,o){"use strict";function s(){var e=l.sceneGraph.find("name","Camera",!0).getComponent("Camera"),a=new t(l);c=new r(l),c.setRenderTarget(new d(l)),c.setCamera(e),l.passes.push(a),l.passes.push(c)}function i(){var e=l.sceneGraph.find("name","Camera",!0).getComponent("Camera"),n=l.sceneGraph.find("name","Camera",!0).getComponent("CameraController"),t=c.renderLayer.renderTarget.clearColor,r={clearColor:[255*t[0],255*t[1],255*t[2],t[3]]},d=document.getElementById("gui"),o=new dat.GUI({width:d.clientWidth,autoPlace:!1});d.appendChild(o.domElement);var s=o.addFolder("Stats");s.add(l.stats.renderer,"triangleCount").listen(),s.add(l.stats.renderer,"vertexCount").listen(),s.add(l.stats.renderer,"drawCalls").listen(),s.add(l.stats,"fps").listen(),s.open();var i=o.addFolder("Scene");i.addColor(r,"clearColor").onChange(function(e){t[0]=e[0]/255,t[1]=e[1]/255,t[2]=e[2]/255});var g=o.addFolder("Camera");g.add(n,"rotateSensitivity"),g.add(n,"panSensitivity"),g.add(n,"zoomSensitivity"),g.add(e,"near").onChange(function(a){e.setNear(a)}),g.add(e,"far").onChange(function(a){e.setFar(a)}),g.add({fov:Math.radToDeg(e.fovy)},"fov").min(5).max(120).onChange(function(a){e.setFovy(Math.degToRad(a))}),o.close(),l.eventHandler.addEventListener(this,function(e){switch(e.type){case a.EVENTS.VIEWPORT:o.width=d.clientWidth}return!1})}var l=void 0,c=void 0;l=new e(document.getElementById("webgl2"),{antialias:!0,debug:!1}),l.gl.enable(l.gl.DEPTH_TEST),l.gl.enable(l.gl.CULL_FACE),o.startLoading("loading",50,"Loading ...");var g=new n(l,{shaderLibrary:"../shaderlibrary/shaders.json"});g.load("scene.json",function(){s(),l.start();var e=function(){0===l.stats.renderer.drawCalls?requestAnimationFrame(e):(i(),o.stopLoading())};e()})});